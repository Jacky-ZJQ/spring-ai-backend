# ---- Compose 基础配置 ----
COMPOSE_PROJECT_NAME=spring-ai
PORTAL_PORT=80
PORTAL_BUILD_CONTEXT=../spring-ai-protal

# ---- MySQL ----
MYSQL_ROOT_PASSWORD=change_root_password
MYSQL_DATABASE=itheima
MYSQL_USER=ai_app
MYSQL_PASSWORD=change_app_password
MYSQL_PORT=3306

# ---- Backend ----
SPRING_PROFILES_ACTIVE=prod
APP_LOG_LEVEL=info
SERVER_PORT=8080
SPRING_AI_CHAT_TEXT_PROVIDER=openai
# 对外 API 前缀（默认 /api；若前端直连后端可设为空）
APP_API_PREFIX=/api
# 定时清理任务：开关 / cron / 保留时长（小时）
APP_MAINTENANCE_CLEANUP_ENABLED=true
APP_MAINTENANCE_CLEANUP_CRON="0 0 4 * * *"
APP_MAINTENANCE_PDF_RETENTION_HOURS=168
APP_MAINTENANCE_IMAGE_RETENTION_HOURS=168
# 手动释放内存时会清理的会话类型
APP_MAINTENANCE_CHAT_TYPES=chat,service,pdf

# ---- AI 调用配额（默认：3600秒内最多15次）----
# 是否开启限流
SPRING_AI_QUOTA_ENABLED=true
# 单窗口最大请求次数
SPRING_AI_QUOTA_MAX_REQUESTS_PER_WINDOW=15
# 时间窗口（秒）
SPRING_AI_QUOTA_WINDOW_SECONDS=3600
# 优先识别用户标识的请求头（没有则按 IP）
SPRING_AI_QUOTA_USER_HEADER=X-User-Id
# 生效路径（逗号分隔）
SPRING_AI_QUOTA_PATH_PATTERNS=/ai/chat,/ai/game,/ai/service,/ai/pdf/chat
# 超限时返回文案
SPRING_AI_QUOTA_ERROR_MESSAGE=模型调用次数已达上限，请稍后再试。

# 如果服务器不跑 Ollama，请改成远程 Ollama 地址（同一局域网或公网）
OLLAMA_BASE_URL=http://host.docker.internal:11434
OLLAMA_CHAT_MODEL=deepseek-r1:1.5b
OLLAMA_TEMPERATURE=0.8

SPRING_AI_OPENAI_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode
OPENAI_API_KEY=replace_with_your_api_key
OPENAI_CHAT_MODEL=qwen-max-latest
OPENAI_CHAT_TEMPERATURE=0.8
OPENAI_EMBEDDING_MODEL=text-embedding-v3
OPENAI_EMBEDDING_DIMENSIONS=1024

MAX_FILE_SIZE=10485760
MAX_REQUEST_SIZE=10485760

# JVM 参数（2核4G 推荐）
JAVA_TOOL_OPTIONS=-XX:+UseG1GC -XX:MaxRAMPercentage=70 -XX:InitialRAMPercentage=20 -XX:MinRAMPercentage=20 -XX:+UseStringDeduplication -Dfile.encoding=UTF-8
